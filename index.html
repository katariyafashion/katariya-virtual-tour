<script>
  document.addEventListener('DOMContentLoaded', function () {
    var viewer, scenes = {};

    var fileMap = {
      "outside": "outside.jpg",
      "mainhall": "mainhall.jpg",
      "dress_material": "dress_material.jpg",
      "pant_set_reception": "pant_set_reception.jpg",
      "pant_set_department": "pant_set_department.jpg",
      "kurtis_upstairs": "kurtis_upstairs.jpg",
      "kurti_downstairs": "kurti_downstairs.jpg"
    };

    function createScene(id, title) {
      var imageUrl = "scenes/" + fileMap[id];
      var source = Marzipano.ImageUrlSource.fromString(imageUrl);
      var geometry = new Marzipano.EquirectGeometry([{ width: 4000 }]);
      var limiter = Marzipano.RectilinearView.limit.traditional(1024, 100 * Math.PI / 180);
      var view = new Marzipano.RectilinearView(null, limiter);

      var scene = viewer.createScene({
        source: source,
        geometry: geometry,
        view: view,
        pinFirstLevel: true
      });

      scenes[id] = { id, title, scene, view };
    }

    function initTour() {
      document.getElementById("startOverlay").style.display = "none";
      viewer = new Marzipano.Viewer(document.getElementById('pano'));

      Object.keys(fileMap).forEach(function(id) {
        createScene(id, id);
      });

      scenes["outside"].scene.switchTo();

      window.gotoScene = function(id) {
        if (scenes[id]) {
          scenes[id].scene.switchTo();
        } else {
          alert("Scene not found: " + id);
        }
      };
    }

    const overlay = document.getElementById("startOverlay");
    overlay.addEventListener("click", initTour, { once: true });
    overlay.addEventListener("touchstart", initTour, { once: true });
  });
</script>
